<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MiTV - TV Remote</title>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<style>
  :root { --ui: rgba(0,0,0,.55); --fg:#fff; --accent:#e50914; }
  html,body{margin:0;height:100%;background:#000}
  video{width:100%;height:100%;display:block;background:#000;outline:none}
  #bar{
    position:fixed;left:0;right:0;top:0;display:flex;gap:.5rem;flex-wrap:wrap;
    align-items:center;padding:.6rem;background:var(--ui);color:var(--fg);
    transform:translateY(0);transition:.25s;backdrop-filter:blur(6px);z-index:10
  }
  #bar.hide{ transform:translateY(-110%); }
  #bar button{
    background:#111;border:1px solid #333;color:#fff;padding:.6rem .8rem;
    border-radius:.6rem;cursor:pointer;font:600 16px system-ui,-apple-system,Segoe UI,Arial
  }
  #bar button.active{ background:var(--accent); border-color:#b30610; }
  #overlay{
    position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.85);
    color:#fff;font:600 20px/1.4 system-ui,-apple-system,Segoe UI,Arial;text-align:center;padding:24px;z-index:9
  }
  #overlay.show{display:grid}
  .hint{opacity:.9;max-width:760px}
</style>
</head>
<body>

<div id="bar" aria-hidden="true">
  <button data-src="https://g3.vxral-hor.transport.edge-access.net/a09/ngrp:cronicatv_video1-100044_all/cronicatv_video1-100044_720p.m3u8">Crónica 720p</button>
  <button data-src="https://g3.vxral-hor.transport.edge-access.net/a09/ngrp:cronicatv_video1-100044_all/cronicatv_video1-100044_480p.m3u8">Crónica 480p</button>
  <button data-src="https://ythls.armelin.one/channel/UC2Qw1dzXDBAZPwS7zm37g8g.m3u8">A24</button>
  <button data-src="https://ythls.armelin.one/channel/UCFgk2Q2mVO1BklRQhSv6p0w.m3u8">C5N</button>
  <button data-src="https://ythls.armelin.one/channel/UCj6PcyLvpnIRT_2W_mwa9Aw.m3u8">TN</button>
  <button data-src="https://ythls.armelin.one/channel/UCba3hpU7EFBSk817y9qZkiA.m3u8">LN+</button>
</div>

<video id="v" autoplay playsinline controls muted></video>

<div id="overlay" class="show">
  <div class="hint">
    Pulsá <b>OK/Enter</b> para activar <b>sonido</b> y <b>pantalla completa</b>.<br/>
    Volumen: <b>Arriba/Abajo</b>.  Play/Pause: tecla de tu control.  Salir FS: <b>Back/Escape</b>.
  </div>
</div>

<script>
(function(){
  const v = document.getElementById('v');
  const overlay = document.getElementById('overlay');
  const bar = document.getElementById('bar');

  const DEFAULT_SRC = "https://g3.vxral-hor.transport.edge-access.net/a09/ngrp:cronicatv_video1-100044_all/cronicatv_video1-100044_720p.m3u8";
  const qs = new URL(location.href).searchParams;
  const SRC = qs.get('src') || DEFAULT_SRC;

  // --- Helpers TV ---
  function showBar(){ bar.classList.remove('hide'); clearTimeout(showBar.t); showBar.t=setTimeout(()=>bar.classList.add('hide'), 4000); }
  async function requestFS(){
    const el=document.documentElement;
    try{
      if(!document.fullscreenElement){
        if(el.requestFullscreen) await el.requestFullscreen();
        else if(el.webkitRequestFullscreen) await el.webkitRequestFullscreen();
      }
    }catch(e){}
  }
  async function soundOn(){ try{ v.muted=false; v.volume=Math.max(0.3,v.volume||1); }catch(e){} try{ await v.play(); }catch(e){} }
  function vol(delta){ v.volume = Math.max(0, Math.min(1, (v.volume||0)+delta)); showBar(); }

  // --- Carga HLS ---
  function load(src){
    if (window.hls){ try{ window.hls.destroy(); }catch(e){} }
    if (window.Hls && Hls.isSupported()){
      window.hls = new Hls({lowLatencyMode:true});
      window.hls.loadSource(src);
      window.hls.attachMedia(v);
    } else if (v.canPlayType('application/vnd.apple.mpegurl')) {
      v.src = src; // Safari/webOS/Tizen suelen soportar
    } else {
      overlay.innerHTML = '<div class="hint">Tu navegador de TV no soporta HLS. Probá con Firefox/TV Bro/Android TV, o usa una app (VLC/Kodi).</div>';
      overlay.classList.add('show');
    }
    // marcar activo
    document.querySelectorAll('#bar button').forEach(b=>b.classList.remove('active'));
    const btn=document.querySelector(`#bar button[data-src="${src}"]`); if(btn) btn.classList.add('active');
  }

  // --- Eventos básicos ---
  v.addEventListener('loadeddata', async ()=>{ try{ await v.play(); }catch(e){} });
  v.addEventListener('playing', ()=> overlay.classList.remove('show'));
  v.addEventListener('pause',   ()=> overlay.classList.add('show'));

  // Teclado / control remoto
  document.addEventListener('keydown', async (e)=>{
    showBar();
    const k = e.key || e.code;

    // OK/Enter → sonido + FS
    if (k==='Enter' || k==='NumpadEnter') { e.preventDefault(); await requestFS(); await soundOn(); overlay.classList.remove('show'); return; }

    // Play/Pause del control
    if (k==='MediaPlayPause' || k==='Play' || k==='Pause') {
      e.preventDefault();
      if (v.paused) { await soundOn(); } else { v.pause(); }
      return;
    }

    // Volumen
    if (k==='ArrowUp')   { e.preventDefault(); vol(+0.05); return; }
    if (k==='ArrowDown') { e.preventDefault(); vol(-0.05); return; }

    // Salir fullscreen
    if (k==='Escape' || k==='Backspace') {
      if (document.fullscreenElement && document.exitFullscreen) { e.preventDefault(); document.exitFullscreen(); }
      return;
    }

    // Flechas izquierda/derecha: mostrar barra (no seek en vivo)
    if (k==='ArrowLeft' || k==='ArrowRight') { e.preventDefault(); return; }
  });

  // Clic/OK con ratón también habilita
  document.addEventListener('pointerdown', async ()=>{
    if (overlay.classList.contains('show')) { await requestFS(); await soundOn(); overlay.classList.remove('show'); }
  });

  // Botones de la barra
  document.querySelectorAll('#bar button[data-src]').forEach(b=>{
    b.addEventListener('click', ()=>load(b.dataset.src));
  });

  // Arranque
  v.muted = true; // para que el autoplay no sea bloqueado en TVs estrictas
  load(SRC);
  showBar();
})();
</script>
</body>
</html>
